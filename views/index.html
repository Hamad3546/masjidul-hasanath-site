<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Masjidul Hasanath | Godamuduna</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Amiri&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #064e3b; --gold: #d4af37; --bg: #f8fafc; --text: #0f172a; --card: #ffffff; --accent: #f0fdf4; }
        [data-theme="dark"] { --primary: #10b981; --gold: #fbbf24; --bg: #020617; --text: #f8fafc; --card: #1e293b; --accent: #064e3b; }

        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Poppins', sans-serif; padding-bottom: 110px; }
        
        /* LOGIN */
        #gatekeeper { position: fixed; inset: 0; background: var(--primary); z-index: 10000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; text-align: center; }
        
        header { background: var(--primary); padding: 20px; color: white; border-bottom: 4px solid var(--gold); border-radius: 0 0 20px 20px; position: sticky; top: 0; z-index: 1000; }
        
        nav { background: var(--card); display: flex; justify-content: space-around; padding: 12px 0; position: fixed; bottom: 0; width: 100%; z-index: 2000; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); border-radius: 20px 20px 0 0; }
        nav button { background: none; border: none; color: #94a3b8; font-size: 0.7rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px; width: 15%; }
        nav button.active { color: var(--primary); font-weight: bold; }

        section { padding: 15px; display: none; animation: fadeIn 0.3s ease; }
        section.active { display: block; }
        .card { background: var(--card); border-radius: 18px; padding: 20px; margin-bottom: 15px; border: 1px solid rgba(0,0,0,0.05); }

        /* ARABIC */
        .arabic { font-family: 'Amiri', serif; font-size: 1.6rem; direction: rtl; color: var(--primary); text-align: right; line-height: 2.2; }
        .dua-card { cursor: pointer; border-left: 5px solid var(--gold); }
        .dua-content { display: none; margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px; }

        /* COMPASS FIX */
        .compass-ui { position: relative; width: 240px; height: 240px; margin: 20px auto; border: 8px solid var(--gold); border-radius: 50%; background: #fff; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        #needle { font-size: 6rem; color: #b91c1c; transition: transform 0.2s linear; transform-origin: center center; }

        .btn-action { background: var(--primary); color: white; padding: 15px; border-radius: 12px; border: none; width: 100%; font-weight: bold; cursor: pointer; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="gatekeeper">
    <div class="gate-box">
        <h1>Masjidul Hasanath</h1>
        <p>Godamuduna, Muruthalawa</p>
        <div id="google-btn-container" style="margin:20px 0;"></div>
        <p style="font-size:0.7rem; opacity:0.8;">Developed for the community by Hamad</p>
    </div>
</div>

<header>
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div><h3 style="margin:0;">Masjidul Hasanath</h3><small>Muruthalawa, Kandy | Dev: Hamad</small></div>
        <i onclick="toggleMode()" class="fas fa-adjust" style="cursor:pointer;"></i>
    </div>
</header>

<section id="home" class="active">
    <div class="card" style="background:var(--primary); color:white; text-align:center;">
        <p style="margin:0; font-size:0.8rem;">Ramadan 2026 Countdown</p>
        <h2 id="cd-timer">---</h2>
        <small>Godamuduna Main, Sri Lanka</small>
    </div>
    <div class="card">
        <h3><i class="fas fa-clock"></i> Prayer Times</h3>
        <div style="display:flex; flex-direction:column; gap:10px;">
            <div style="display:flex; justify-content:space-between;"><span>Fajr</span><b>5:09 AM</b></div>
            <div style="display:flex; justify-content:space-between;"><span>Dhuhr</span><b>12:24 PM</b></div>
            <div style="display:flex; justify-content:space-between; color:var(--primary); font-weight:bold;"><span>Asr</span><b>3:46 PM</b></div>
            <div style="display:flex; justify-content:space-between; color:var(--gold);"><span>Maghrib</span><b>6:19 PM</b></div>
            <div style="display:flex; justify-content:space-between;"><span>Isha</span><b>7:30 PM</b></div>
        </div>
    </div>
</section>

<section id="qibla">
    <div class="card" style="text-align:center;">
        <h3>Qibla Finder</h3>
        <p style="font-size:0.75rem;">Godamuduna, Muruthalawa Calibration</p>
        <div class="compass-ui"><i id="needle" class="fas fa-location-arrow"></i></div>
        <h2 id="q-val">0°</h2>
        <button class="btn-action" onclick="initCompass()">ACTIVATE COMPASS</button>
        <p style="font-size:0.65rem; margin-top:10px; color:#666;">Hold phone flat. Points to Makkah from Kandy.</p>
    </div>
</section>

<section id="duas">
    <div class="card"><h3><i class="fas fa-hands-praying"></i> 45 Arabic Duas</h3><div id="dua-list"></div></div>
</section>

<section id="me">
    <div class="card" style="text-align:center;">
        <div style="width:80px; height:80px; background:var(--gold); border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center; color:white; font-size:2rem;"><i class="fas fa-user-tie"></i></div>
        <h2 style="margin:0;">Hamad</h2>
        <span style="background:var(--primary); color:white; padding:4px 12px; border-radius:20px; font-size:0.7rem;">Founder & Developer | Age: 16</span>
        <p style="text-align:left; font-size:0.9rem; line-height:1.6; margin-top:15px;">
            I am Hamad, the 16-year-old developer from Godamuduna. I have worked incredibly hard to code this site for our community in Muruthalawa. Every feature, from the Arabic Duas to the Qibla sensor, was built by me to help our mosque stay connected. 
            <br><br>
            Please feel free to suggest improvements to make my site better.
        </p>
        <a href="mailto:hamadfazmil455@gmail.com" class="btn-action" style="text-decoration:none; display:block;">Email Me Suggestions</a>
        
        <div class="card" style="margin-top:20px; background:var(--accent);">
            <h4><i class="fas fa-star"></i> Ask Dua for Me</h4>
            <p style="font-size:0.8rem;">Request a dua from the community through Hamad's platform.</p>
            <input type="text" id="dua-req-box" placeholder="Your name or request..." style="width:85%; padding:12px; border-radius:10px; border:1px solid #ddd; margin-bottom:10px;">
            <button onclick="alert('Dua request submitted to Hamad!')" style="background:var(--gold); border:none; padding:10px; width:100%; border-radius:10px; font-weight:bold;">Submit</button>
        </div>
    </div>
</section>

<section id="bot">
    <div class="card">
        <h3>Hasanath AI</h3>
        <div id="chat-win" style="height:300px; background:var(--accent); overflow-y:auto; padding:15px; border-radius:15px; margin-bottom:10px;"></div>
        <div style="display:flex; gap:5px;"><input id="bot-inp" style="flex:1; padding:12px; border-radius:10px; border:1px solid #ddd;"><button onclick="sendMsg()" class="btn-action" style="width:auto;"><i class="fas fa-paper-plane"></i></button></div>
    </div>
</section>

<nav>
    <button onclick="tab('home', this)" class="active"><i class="fas fa-home"></i><span>Home</span></button>
    <button onclick="tab('qibla', this)"><i class="fas fa-compass"></i><span>Qibla</span></button>
    <button onclick="tab('duas', this)"><i class="fas fa-heart"></i><span>Duas</span></button>
    <button onclick="tab('me', this)"><i class="fas fa-user-check"></i><span>Hamad</span></button>
    <button onclick="tab('bot', this)"><i class="fas fa-robot"></i><span>AI</span></button>
</nav>

<script>
    const duaData = [
        { t: "Waking Up", a: "الْحَمْدُ لِلَّهِ الَّذِي أَحْيَانَا بَعْدَ مَا أَمَاتَنَا وَإِلَيْهِ النُّشُورُ", m: "Praise is to Allah who gave us life after death." },
        { t: "Before Eating", a: "بِسْمِ اللَّهِ", m: "In the name of Allah." },
        { t: "After Eating", a: "الْحَمْدُ لِلَّهِ الَّذِي أَطْعَمَنَا وَسَقَانَا وَجَعَلَنَا مُسْلِمِينَ", m: "Praise be to Allah who fed us." }
    ];

    window.onload = function () {
        google.accounts.id.initialize({
            client_id: "318225024149-0hjour8gpcp0in6l9ksb415ba6aqvn03.apps.googleusercontent.com",
            callback: (r) => { document.getElementById('gatekeeper').style.display='none'; }
        });
        google.accounts.id.renderButton(document.getElementById("google-btn-container"), { theme: "outline", size: "large" });
        loadDuas();
        setInterval(countdown, 1000);
    };

    function loadDuas() {
        let h = "";
        for(let i=0; i<45; i++) {
            let d = duaData[i] || { t: "Dua " + (i+1), a: "قريباً", m: "Translation being verified by Hamad." };
            h += `<div class="card dua-card" onclick="toggleDua(${i})"><strong>${i+1}. ${d.t}</strong><div id="dc-${i}" class="dua-content"><p class="arabic">${d.a}</p><p>${d.m}</p></div></div>`;
        }
        document.getElementById('dua-list').innerHTML = h;
    }

    function toggleDua(i) { let e = document.getElementById('dc-'+i); e.style.display = e.style.display==='block' ? 'none' : 'block'; }

    function initCompass() {
        if (typeof DeviceOrientationEvent.requestPermission === 'function') {
            DeviceOrientationEvent.requestPermission().then(s => { if(s=='granted') startSensors(); });
        } else { startSensors(); }
    }

    function startSensors() {
        window.addEventListener('deviceorientationabsolute', (e) => {
            let h = e.webkitCompassHeading || e.alpha;
            if(h) {
                // Qibla for Kandy Sri Lanka is ~298.5
                let qibla = 298.5;
                let rotation = h - qibla;
                document.getElementById('needle').style.transform = `rotate(${-rotation}deg)`;
                document.getElementById('q-val').innerText = Math.round(h) + "°";
            }
        }, true);
    }

    function tab(id, btn) {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }

    function countdown() {
        let diff = new Date("February 19, 2026 00:00:00") - new Date();
        if(diff < 0) { document.getElementById('cd-timer').innerText = "Ramadan Mubarak!"; return; }
        document.getElementById('cd-timer').innerText = Math.floor(diff/86400000) + "d " + Math.floor((diff%86400000)/3600000) + "h " + Math.floor((diff%3600000)/60000) + "m";
    }

    function sendMsg() {
        let v = document.getElementById('bot-inp').value; if(!v) return;
        document.getElementById('chat-win').innerHTML += `<p style="text-align:right;"><b>You:</b> ${v}</p><p><b>AI:</b> Hamad's system is processing your request...</p>`;
        document.getElementById('bot-inp').value = "";
    }

    function toggleMode() {
        let d = document.documentElement;
        d.setAttribute('data-theme', d.getAttribute('data-theme') === 'dark' ? 'light' : 'dark');
    }
</script>
</body>
</html>
